{
    "collab_server" : "",
    "contents" : " \n\n# ============================================================\n# CASO 1 : magnesio: plantas fertilizadas com 2 mM de Magnesio\n# comparada a plantas sem Mg quanto ao comprimento de lesão\n# Objetivo: avaliar o efeito da suplementacao com Magnesio na suppressao do crescimento da lesao\n# Hipótese nula: O comprimento da lesão não difere entre os tratamentos com e sem suplementacao\n# Número de fatores(níveis): 1 - Magnésio (com e sem)\n# Número de variáveis: 1\n# Nome e tipo de variável observada: comprimento da lesão (mm): numérica contínua\n# Número de repetições: 10\n# Desenho experimental: inteiramente casualizado\n# Amostras independentes? sim\n# Qual teste usar? teste t ou Kolmogorov-Smirnov (não paramétrico)\n# ================================\n  \n# importa\nlibrary(readxl)\nmagnesio <- read_excel(\"dados-diversos.xlsx\", 1)\nhead(magnesio)\n\n# visualiza\nlibrary(ggplot2)\nggplot(magnesio, aes(trat, comp))+\n# geom_boxplot()+\n geom_point()\n#geom_point()\n\n# arruma o conjunto\nlibrary(tidyr)\n# separa as variáveis em duas colunas\nmagnesio2 <- spread(magnesio, trat, comp)\n\n# verifica as premissas para teste paramétrico\n\n## homocedasticidade\nattach(magnesio2)\nvar.test(Mg2, control)$p.value\n\n## normalidade\nshapiro.test(Mg2)$p.value\nshapiro.test(control)$p.value\nqqnorm(Mg2); qqline(Mg2)\nqqnorm(control); qqline(control)\n\n# sumariza com pastecs\nlibrary(pastecs)\ndesc1 <- stat.desc(magnesio2[2:3], basic = F)\ndesc1\n\n# sumarização com dplyr\nlibrary(dplyr)\nmagnesio3 <- summarize(group_by(magnesio, trat), \n        mu = mean(comp),\n        sd = sd(comp),\n        n = length(comp),\n        se = sd / sqrt(n),\n        ciu = mu + (qt(0.025, df = n-1)*se),\n        cil = mu - (qt(0.025, df = n-1)*se))\n        \n# barras de erro: SE, SD e CI95%\nggplot(magnesio3, aes(trat, mu))+\n      geom_point(stat = \"identity\", size=3, shape=1)+\n      geom_errorbar(aes(min = mu - se , max = mu + se), width=.2)+\n      geom_errorbar(aes(min = mu - sd, max = mu + sd), \n                    width=.5, color = \"blue\")+\n      geom_errorbar(aes(min = cil, max = ciu), \n                    width=1, size=1, color=\"red\")    \n\n# teste t para dois grupos independentes\nattach(magnesio2)\nt_magnesio <- t.test(Mg2, control)\nt_magnesio$statistic\nt_magnesio$p.value\n\n# extrai as estatísticas do teste\nlibrary(broom)\nt_broom <-tidy(t_magnesio)\nglimpse(t_broom)\n\n# descrição do resultado\n# O tratamento com suplemento de 2mM de Magnésio reduziu significtivamente (P < 0.0001) o tamanho da lesão, comparado o tratamento sem suplementação de magnésio.\n\n\n\n\n# =======================================================================\n# CASO 2 - validação de escala diagramática\n# Objetivo: avaliar o efeito do uso da escala na acurácia, precisão e vieses sistemáticos de avaliações visuais de severidade\n# Os tratamentos constam de avaliações pelo mesmo indivíduo sem e com o auxílio da escala diagramática\n# Nome e número de fatores(níveis): 1 fator escala (sem e com)\n# As repetições são 10 avaliadores escolhidos aleatoriamente\n# Número de variáveis: 5 variáveis contínuas (taxa 0 a 1)\n# hipótese estatística: as médias de acurácia não diferem nas duas condições\n# Amostras independentes? não\n# Teste a usar? test-t pareado\n# ===========================================================\n\n# importa\nescala <- read_excel(\"dados-diversos.xlsx\", \"escala\")\nhead(escala)\n\n# visualiza\nlibrary(ggplot2)\nggplot(escala, aes(reorder(assessment, acuracia), acuracia))+\n geom_boxplot()+labs(x =\"Assessment\", y = \"Accuracy\")\n\n# arruma os dados\nlibrary(tidyr)\nescala2 <- select(escala, assessment, rater, acuracia)\nescala3 <- spread(escala2, assessment, acuracia)\n\n# verifica premissas anova\n\n## homocedasticidade dois grupos\nattach(escala3)\nvar.test(Aided1, Unaided)$p.value\n\n## normalidade\nshapiro.test(Aided1)$p.value\nshapiro.test(Unaided)$p.value\nqqnorm(Aided1)\nqqline(Aided1)\nqqnorm(Unaided)\nqqline(Unaided)\n\n# summariza\nlibrary(pastecs)\ndesc_escala <- stat.desc(escala3[2:3], basic=F)\ndesc_escala\n\nescala4 <- summarize(group_by(escala2, assessment), \n                      mu = mean(acuracia),\n                      sd = sd(acuracia),\n                      n = length(acuracia),\n                      se = sd / sqrt(n),\n                      ciu = mu + (qt(0.025, df = n-1)*se),\n                      cil = mu - (qt(0.025, df = n-1)*se))\n\nggplot(escala4, aes(assessment, mu))+\n      geom_point(stat = \"identity\")+\n      #geom_errorbar(aes(min = mu - se , max = mu + se), width=.1)+\n      #geom_errorbar(aes(min = mu - sd, max = mu + sd), \n       #             width=.3, color = \"blue\")+\n      geom_errorbar(aes(min = cil, max = ciu), \n                    width=.2,  color=\"red\")    \n\n# compara médias\n## teste t para amostras pareadas\nt_escala <- t.test(escala3$Aided1,escala3$Unaided, \n                   paired = TRUE, var.equal = F)\n\n## extrai algumas estatísticas do teste\nlibrary(broom)\ntidy(t_escala)\n\n## visualiza por avaliador (sem e com)\nggplot(escala2, aes(reorder(assessment, acuracia), acuracia, group = rater))+ geom_point(stat = \"identity\", size=3, shape=1)+\n geom_line(size=1, color = \"gray70\")+ facet_wrap(~ rater, nrow=5)\n\n## teste não paramétrico\nwilcox.test(escala3$Aided1,escala3$Unaided, paired = TRUE)\n\n\n\n\n# =====================================================\n# CASO 3 - Crescimento micelial de espécies de fungo\n# Objetivo: determinar a taxa de crescimento micelial para três espécies do fungo\n# hipótese nula: as médias da TCM não diferem entre as cinco espécies\n# Fatores: espécies, 5 níveis\n# Variáveis: TCM = taxa de crescimento micelial\n# ===============================================\n\n# importa\nmicelial <- read_excel(\"dados-diversos.xlsx\", \"micelial\")\nhead(micelial)\n\n# visualiza\nggplot(micelial, aes(especie, tcm))+\n  geom_boxplot()\n#geom_point()\n\n# premissas da anova\n## homocedasticidade\nattach(micelial)\nbartlett.test(tcm ~ especie)$p.value\nlibrary(car)\nleveneTest (tcm ~ factor(especie))[3] # library car\n\n## normalidade das observações\nqqnorm(tcm)\nqqline(tcm)\n\n# sumarização\nmicelial2 <- summarize(group_by(micelial, especie), \n                    mu = mean(tcm),\n                    sd = sd(tcm),\n                    n = length(tcm),\n                    se = sd / sqrt(n),\n                    ciu = mu + (qt(0.025, df = n-1)*se),\n                    cil = mu - (qt(0.025, df = n-1)*se))\n\n# grafico \nggplot(micelial2, aes(especie, mu))+\n      geom_point(stat = \"identity\")+\n      #geom_errorbar(aes(min = mu - se , max = mu + se), width=.1)+\n      #geom_errorbar(aes(min = mu - sd, max = mu + sd), width=.3, color = \"blue\")+\n      geom_errorbar(aes(min = cil, max = ciu), width=1,  color=\"red\")\n\n# Anova\nlibrary(easyanova)\ndata_m1 <- select(micelial, c(1, 3))\nm1 <- ea1(data_m1, design=1) \nm1\n\n## significancia da Anova\nm1$`Analysis of variance`\n\n## verifica os resíduos\nm1$`Residual analysis`\n\n## usando a funcão lm do base R\nm2 <- lm(tcm ~ especie, data = data_m1)\nsummary(m2)\nanova(m2)\nhist(m2$residuals) # função hist do pacote base graphics\nshapiro.test(m2$residuals)\n\n# teste de comparação de médias\nm1$Means\n\n\n# =======================================================\n# CASO 4 - inseticida e número de insetos\n# Fonte: Beall, G., (1942) The Transformation of data \n# from entomological field experiments, Biometrika, 29, 243–262.\n# Dados no pacote \"datasets\" do R. data(InsectSprays)\n# =======================================================\n\n# Importa\ndata(InsectSprays)\nlibrary(magrittr)\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# arruma\ninsects <- tbl_df(InsectSprays)%>%\n           select(spray, count)\n\n# visualiza\nggplot(insects, aes(spray, count))+\n           geom_boxplot()\n\n# Modelo de anova\nlibrary(easyanova)\nm2 <- ea1(insects, design=1)\nm2$`Residual analysis`\nm2$`Residual analysis`[1] # shapiro.test\nm2$`Residual analysis`[2] # bartlett\n\n# verifica visualmente o ajuste\npar(mfrow = c(2,2))\nplot(lm(count ~ spray, data = insects))\npar(mfrow = c(1,1))\n\nhist(residuals(aov(count ~ spray, data = insects)))\nbartlett.test(count ~ spray, data = insects)$p.value\n# \n\n# compara médias\nm2$Means[c(2,4)] # tukey\nm2$Means[c(2,7)] # scott-knot\n\n# problemas na premissa da Anova: 3 soluções abaixo\n\n# solução 1: transformação raiz quadrada\ninsects <- mutate(insects, count2 = sqrt(count))\nm3 <- ea1(insects[c(1,3)], design=1)\n\n# premissas anova\nm3$`Residual analysis`[1]\nm3$`Residual analysis`[2]\n\nm3$Means\n\n# solução 2: kruskal-wallis\nkruskal.test(count ~ spray, data = insects)\nlibrary(agricolae)\nattach(insects)\nkruskal(count, spray,console = TRUE)\n\n# solução 3: glm com distribuição de poisson\n# distribuição da variável\nhist(insects$count)\n\n# modelo linear generalizado\nm4 <- glm(count ~ spray, data = insects, family = poisson(link = \"identity\")) \nsummary(m4)\nhist(residuals(m4))\n\n# resultados extraidos da lista\nlibrary(broom)\ntidy(m4)\n\n# ajuste do modelo\nlibrary(boot)\nm4.diag <- glm.diag(m4)\nglm.diag.plots(m4, glm.diag(m4))\n\n# comparação de médias\nlibrary(multcomp)\ncompara2 <- glht(m4, linfct = mcp(spray = \"Tukey\"))\nplot(compara2)\n\nlibrary(lsmeans)\nmedias2 <- lsmeans(m4, ~ spray, Letters = LETTERS)\ncld(medias2, by = NULL, Letters = LETTERS, alpha = .05)  \n\nplot(cld(medias2, by = NULL, Letters = LETTERS, alpha = .05))\n\nlibrary(factorplot)\nfp <- factorplot(compara2, adjust.method=\"holm\")\nplot(fp, abbrev.char = 100)\n\n\n\n# ========================================\n# CASO 4 - mortalidade de insetos\n# ============================\n\n# importa\n\nmortalidade <- read_excel(\"dados-diversos.xlsx\", \"mortalidade\")\n\n# transforma\nmortalidade <- mutate(mortalidade, mortos2 = mortos/10)\n\n# visualiza\nggplot(mortalidade, aes(inseticida, mortos2)) + geom_boxplot()\n\n# transforma\nmortalidade <- mutate(mortalidade, as.factor(inseticida))\n\n# modelo glm com a familia binomial\nm_glm <- glm(cbind(mortos, vivos)~ inseticida, family = binomial(link=\"logit\"), data = mortalidade)\nsummary(m_glm)\nlibrary(car)\nAnova(m_glm)\n\n# visualiza residuos do ajuste\n\nhist(residuals(m_glm))\nsummary(m_glm)\ntidy(m_glm)\n\n# diagnóstico do ajuste ao modelo\nlibrary(boot)\nglm.diag.plots(m_glm, glm.diag(m_glm))\n\n\nlibrary(lsmeans)\nmedias_inseticida <- lsmeans(m_glm, ~ inseticida, Letters = LETTERS)\ncld(medias_inseticida, by = NULL, Letters = LETTERS, alpha = .05)  \n\n\n\n# ==============================\n# Caso 5 - Experimento em arranjo fatorial\n# =============================\n\n# importa\nionic <- read_excel(\"dados-diversos.xlsx\", \"fungicida_vaso\")\n\n# transforma\nlibrary(dplyr)\nionic <- mutate(ionic, sev = dis_sp/n_sp)\n\n# visualiza\nlibrary(ggplot2)\nggplot(ionic, aes(factor(dose), sev))+\n  geom_jitter(width = 0.2)+ facet_grid(~ treat)\n\n# visualiza a interação \nattach(ionic)\npar(mfrow=c(1,1))\ninteraction.plot(treat, dose, sev, xlab=\"Treat\")\ninteraction.plot(dose, treat, sev,xlab=\"dose\")\ndetach(ionic)\n\n# ajusta o modelo linear com a interação (treat*dose)\n\n# usando a função aov do R\nlm_fat1 <- aov(sev ~ treat*dose, data = ionic)\nsummary(lm_fat1)\nanova(lm_fat1)\n\n# usando o pacote easyanova\nlibrary(easyanova)\nfat1 <- ea2(ionic[c(1:2,8)], design=1)\nfat1$`Residual analysis`[1:2]\n\n# verifica premissas\n# viola as duas premissas\nhist(log(ionic$sev))\nhist(ionic$sev)\n\n# Solução 1\n# transforma as observações para raiz quadrada e log + 0.5\nionic <- mutate(ionic, sev2 = sqrt(dis_sp/n_sp)/100)\nionic <- mutate(ionic, sev3 = log(sev+0.5))\n\nfat2 <- ea2(ionic[c(1:2,9)], design=1)\nfat2$`Residual analysis`\n\n\n# monta a tabela\nfat2$`Adjusted means (factor 1 in levels of factor 2)`[c(1,2)]\nfat2$`Adjusted means (factor 2 in levels of factor 1)`[c(1,2)]\n\n\n\n# Solução 2 \n# usa glm\nfat_glm <- glm(sev ~ treat * dose, data = ionic, family = gaussian) \nsummary(fat_glm)\nlibrary(car)\nAnova(fat_glm)\nhist(residuals(fat_glm))\nlibrary(broom)\ntidy(fat_glm)\n\n# diagnóstico do ajuste\nlibrary(boot)\nglm.diag.plots(fat_glm, glm.diag(fat_glm))\n\n\n# ===============================================\n# Caso 6  - Fungicida\n# Objetivo: avaliar o efeito de cinco fungicidas na severidade \n# da ferrugem asiática da soja e produtividade da cultura\n# Experimento delineado em blocos casualisados\n# variáveis: uma avaliação de severidade e produtividade no final do ciclo\n# fator fungicida, 5 níveis\n# Tese a usar: anova e comparação de média\n# =================================================\n\n# importa\nferrugem <- read_excel(\"dados-diversos.xlsx\", \"fungicida_campo\")\n\n# visualiza\nggplot(ferrugem, aes(reorder(trat, -sev), sev))+\n  geom_jitter(width=0.2)+\n  ylim(0,100)\n#geom_point()\n\n# model\n# Model\nm_ferrugem <- ea1(ferrugem[c(1,2,3)], design=2)\nm_ferrugem$`Residual analysis`[1] # shapiro.test\nm_ferrugem$`Residual analysis`[2] # bartlett\n\n# comunica - formata a tabela\nlibrary(tidyr)\ntable_ferrugem <- data.frame(m_ferrugem$`Adjusted means`[c(1,2,4)])\ntable_ferrugem <- rename(table_ferrugem, Treatment = treatment, Mean = adjusted.mean)\ntable_ferrugem$Mean <- round(table_ferrugem$Mean, 1)\ntable_ferrugem2 <- unite(table_ferrugem, Means, Mean, tukey, sep = \"\")\n\n# monta a tabela em formato md\nlibrary(knitr)\nkable(table_ferrugem2)\n\n\n# ==============================================\n# caso 7 - experimento em parcelas subdivididas e blocos casualizados\n# =======================\n\n# importa\nmilho <- read_excel(\"dados-diversos.xlsx\", \"milho\")\n\n# visualiza\nggplot(milho, aes(hybrid, yield, group = method, shape = method, color=method))+ geom_point(size=2)\n\n# visualiza a interação\nattach(milho)\npar(mfrow=c(1,1))\ninteraction.plot(hybrid, method, yield, xlab=\"hybrid\")\ninteraction.plot(method, hybrid, yield,xlab=\"method\")\n\n# anova para parcela subdividida\nsplit_milho =ea2(milho[-4], design=5)\nsplit_milho$`Residual analysis`\nsplit_milho\n\n# no pacote agricolae\nlibrary(agricolae)\nattach(milho)\nmodel<-sp.plot(block, hybrid, method, yield)\ndetach(milho)\n\n\n# ==========================\n# caso 8 - um fator com blocos não repetidos \n# Efeito de três tipos de tratamentos (escarificação; hormônio; escarificação+hormonio)\n# As sementes foram divididas em 10 blocos de 60 sementes em uma mesma faixa de peso\n# Assim cada tratamento foi utilizado em 20 sementes de cada grupo. \n# ============================\n\n# importa \nsemente <- read_excel(\"dados-diversos.xlsx\", \"germina_semente\")\n\n# visualiza\nggplot(semente, aes(peso, germ))+\n  geom_boxplot(width = 0.2)+\n facet_wrap(~trat)\n\n# tratamento e covariável\nggplot(semente, aes(peso, germ))+\n  geom_jitter(width = 0.2)+ facet_wrap(~ trat)\n\n\n# modelo de anova paramétrico\nlm_semente <- ea1 (semente[c(1,3)], design=1 )\nlm_semente$`Residual analysis`\n# violação premissas\n\n# Teste de Friedman\n# Performs a Friedman rank sum test with unreplicated blocked data.\n# friedman.test can be used for analyzing unreplicated complete block designs (i.e., there is exactly one observation in y for each combination of levels of groups and blocks) where the normality assumption may be violated.\n\n# no easyanova\nmfried_semente <- ea1(semente, design=15)\n\n# no R base\nfriedman.test(germ ~ trat | peso, data=semente)\n\n\n# =========================\n# CASO 9 - Regressão linear e correlação\n#  =================\n\ndat <- data.frame(cars)\nplot(dat$speed, dat$dist)\nattach(dat)\ncor.test(speed, dist) \n\n# Começamos relizando o ajuste de um reta y=a+b*x, sendo este o ajuste o modelo\n# mais simples, com a função \"lm\" podemos realizar os ajustes lineares\najuste1<-lm(dist ~ speed)\nsummary(ajuste1)\n\n\n# Dado o ajuste realizado, executaremos a ANOVA pertinente a regressão, onde sob \n# H0 todos os coeficientes são iguais a 0, e sob H1 pelo menos um deles é diferente de\n\nanova(ajuste1)\n\n# Com o modelo ajustado devemos começar a realizar as analises dos residuos para \n# verificar se os pressupostos foram atendidos. Neste primeiro monento faremos isso de \n# maneira grafica.\n\npar(mfrow=c(2,2))\nplot(ajuste1)\n\n# Adicionalmente a analise grafica podemos realizar o teste de Shapiro-Wilk, onde sob\n# H0 os residuos tem distribuição normal, e sob H1 não tem distribuição normal\nhist(ajuste1$residuals)\nshapiro.test(ajuste1$resi)\n\n# Verificado o ajuste e os pressupostos podemos plotar os dados e a equação estimada.\n\nplot(speed,dist,xlab=\"speed\",ylab=\"dist\")\nabline(ajuste1)\n\n# Como segunda opção podemos ajustar y=a+b*x+c*x^2, utilizamos a função \"I()\" para\n# especificar modelos lineares polinomiais como neste caso\n\najuste2<-lm(dist~I(speed)+I(speed^2))\nsummary(ajuste2)\nanova(ajuste2)\npar(mfrow=c(2,2))\nplot(ajuste2)\nshapiro.test(ajuste2$resi)\n\n# qualidade do ajuste\nAIC(ajuste1)\nAIC(ajuste2)\nplot(speed,dist, main=\"Cana versus K\")\nabline(ajuste1)\n\n\n# no ggplot\nlibrary(ggplot2)\nggplot(dat, aes(speed, dist))+ geom_point()+\n geom_smooth(method=\"lm\", se=F, color=\"black\")+\n geom_smooth(se=F, method = \"lm\", formula = y ~ poly(x, 2)) \n\n# regressão quadrática\ndat$speed2 <- speed^2\nlm1 <- lm(dist ~ speed2, data = dat)\nsummary(lm1)\nlm2 <- lm(dist ~ speed + speed2, data = dat)\nsummary(lm2)\npredict(lm2)\nlibrary(epiR)\npred1 <- predict(ajuste1)\npred2 <- predict(ajuste2)\nepi.ccc(pred1, dat$dist)$rho.c\nepi.ccc(pred2, dat$dist)$rho.c\n\n\n\n# ==========\n# caso 10 - mofo branco\n\n\n# importa dados\nmofo <- read_excel(\"dados-diversos.xlsx\", \"mofo\")\n\n# visualiza\nggplot(mofo, aes(inc, yld))+\n geom_point(shape = 1)+ facet_wrap(~ study)+\n geom_smooth(span = 5, color = \"black\")\n#geom_smooth(method = \"lm\", formula = y ~ poly(x, 2), color = \"gray\", se = F)\n\nlm_mofo2 <- lm(yld ~ inc + study, data = mofo)\nAnova(lm_mofo2)\n\nmofo <- group_by(mofo, study)\nlm_mofo <- do(mofo, tidy(lm(.$yld ~ .$inc), conf.int=TRUE))\n\n\nlm_mofo2 <- spread(lm_mofo[1:3], term, estimate)\nlm_mofo2\n\nlibrary(lme4)\nlm_mofo3 <- lmer(yld ~ inc + (inc |study), data=mofo, REML=F)\nlm_mofo3\nsummary(lm_mofo3)\n\n\n\n\n\n# caso 11\n# número de plantas emergidas em função de incremento de incidência de B. oryzae na semente\nlibrary(readxl)\nestande <- read_excel(\"dados-diversos.xlsx\", \"estande\")\n\n\n# visualiza\nggplot(estande, aes(trat, nplants))+\n geom_point(shape = 1)+ facet_wrap(~ exp)+\n geom_smooth(method = \"lm\", se = F, color = \"black\")+\n theme_bw()\n\n# transforma\nlibrary(dplyr)\nestande2 <- summarize(group_by(estande, exp, trat), \n                      mean_nplant = mean(nplants))\n\n\n# visualiza\nggplot(estande2, aes(trat, mean_nplant))+\n geom_point(shape = 1)+ facet_wrap(~ exp)+\n geom_smooth(method = \"lm\", se = F, color = \"black\")+\n geom_smooth(method = \"lm\", formula = y ~ poly(x, 2), color = \"gray\", se = F)+\n theme_bw()\n\n# modela\n\nestande2 <- filter(estande, exp == 1)\n\nestande2$trat2 <- estande2$tratˆ2\n\nglm_estande2 <- glm(nplants ~ trat+bloco, family = poisson, data = estande2)\nsummary(glm_estande2)\nAnova(glm_estande2)\n\nlibrary(car)\nAnova(glm_estande)\nsummary(glm_estande)\n\n\nglm_estande22 <- lm(nplants ~ trat+bloco,  data = estande2)\nAnova(glm_estande22)\nsummary(glm_estande22)\n\nlibrary(lme4)\nm1_estande <- lmer(nplants ~ trat + (1 | bloco) + (1 | exp),  data = estande)\n\nAnova(m1_estande)\nsummary(m1_estande)\ncoef(m1_estande)\n\n\n\n# CASO 12 \n# exemplo teste qui-quadrado\nestande <- read_excel(\"dados-diversos.xlsx\", \"survey\")\n\n\n# separa o conjunto para RS\nestande_RS <- filter(estande, state == \"RS\")\n\nlibrary(MASS)\nattach(estande_RS)\ntbl_year <- table(year, species)\ntbl_year\nchisq.test(tbl_year)\n\n\ntbl_inc_class <- table(inc_class, species)\ntbl_inc_class\nchisq.test(tbl_inc_class)\n\n\ntbl_res <- table(residue, species)\ntbl_res\nchisq.test(tbl_res)\nfisher.test(tbl_res)\n\n# Análise de correlação\n# For example, the file http://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data contains data on concentrations of 13 different chemicals in wines grown in the same region in Italy that are derived from three different cultivars.\n\nlibrary(readr)\nwine <- read.table(\"http://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data\", sep=\",\")\n\nlibrary(car)\n\n# usa somente da variável 2 a 6\nwine2 <- wine[2:6]\n\n# matriz de correlação\nscatterplotMatrix(wine2)\n\n\n#  Análise de concordância\nlibrary(readxl)\ndat_cor <- read_excel(\"dados-diversos.xlsx\", \"kendall\")\n\nlibrary(irr)\nkendall(dat_cor, TRUE)\nmeancor(dat_cor, fisher = TRUE)\ncor(dat_cor, method = \"kendall\", use=\"pairwise\")\ncor(dat_cor, method = \"kendall\")\n\n",
    "created" : 1466170449300.000,
    "dirty" : false,
    "encoding" : "UTF-8-MAC",
    "folds" : "",
    "hash" : "3211846544",
    "id" : "3031E231",
    "lastKnownWriteTime" : 1466131297,
    "last_content_update" : 1466131297,
    "path" : "~/Dropbox/course-material/fip606/2016/modela-dados/inferencial-testes.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}